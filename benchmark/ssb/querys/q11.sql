-- Q4.1

SELECT
    D_YEAR,
    C_NATION,
    sum(LO_REVENUE - LO_SUPPLYCOST) AS PROFIT
FROM
    date
JOIN
    lineorder ON LO_ORDERDATE = D_DATEKEY
JOIN
    customer ON LO_CUSTKEY = C_CUSTKEY
JOIN
    supplier ON LO_SUPPKEY = S_SUPPKEY
JOIN
    part ON LO_PARTKEY = P_PARTKEY
WHERE
    C_REGION = 'AMERICA'
    AND S_REGION = 'AMERICA'
    AND P_MFGR IN ('MFGR#1', 'MFGR#2')
GROUP BY
    D_YEAR,
    C_NATION
ORDER BY
    D_YEAR,
    C_NATION;
